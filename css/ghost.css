/* ----- ghost container under the title ----- */

#ghost{
  position: fixed;
  left: 50%;
  top: 50%;                        /* <— center vertically */
  transform: translate(-50%,-50%); /* <— center both axes */
  color: #e7ebf4;
  opacity: 0;
  transition: opacity 700ms ease, transform 900ms cubic-bezier(.2,.9,.1,1);
  pointer-events: none;
  z-index: 9999;
    --bobAmp: 22px;   /* vertical travel (try 28–34px for huge) */
  --bobDur: 5.2s;   /* cycle duration  (lower = faster)        */
}
#ghost.on{ opacity:1; transform: translate(-50%,-50%) }



/* Sprite stays hidden until .ready — ONLY BREATHE LIVES HERE */
#ghost .sprite{
  position: relative;
  width: clamp(160px, 22vw, 300px);
  height: auto;
  opacity: 0;
  transition: opacity 380ms ease;
  animation: ghostBreathe 5.2s ease-in-out infinite; /* scaleY only */
  filter: drop-shadow(0 10px 28px rgba(255,255,255,.10));
  z-index: 1;
}
#ghost.ready .sprite { opacity: 1; }
/* only the bob-wrapper translates on Y — keeps centering pristine */
#ghost .idle-bob{
  animation: ghostBob var(--bobDur) cubic-bezier(.22,.61,.33,1) infinite;
  will-change: transform;
}

/* bigger swing; clean midpoint at 50% for a gentle “hover” feel */
@keyframes ghostBob{
  0%   { transform: translateY(calc(var(--bobAmp) * -0.00)); }
  25%  { transform: translateY(calc(var(--bobAmp) * -0.55)); }
  50%  { transform: translateY(calc(var(--bobAmp) * -1.00)); }
  75%  { transform: translateY(calc(var(--bobAmp) * -0.55)); }
  100% { transform: translateY(calc(var(--bobAmp) * -0.00)); }
}

/* Optional: add a *tiny* rotation to sell the float more */
#ghost .idle-tilt{
  animation: ghostTilt 9.8s ease-in-out infinite;
}
@keyframes ghostTilt{
  0%,100%{ transform: rotate(0deg) }
  50%    { transform: rotate(-1.8deg) }
}
@keyframes ghostBob     { 0%,100%{ transform: translateY(0) } 50%{ transform: translateY(-7px) } }
@keyframes ghostTilt    { 0%,100%{ transform: rotate(0deg) }  50%{ transform: rotate(-1.2deg) } }
@keyframes ghostBreathe { 0%,100%{ transform: scaleY(1) }     50%{ transform: scaleY(0.985) } }
#ghost.ready .sprite { opacity: 1; }
/* ===== COLOR-GLITCH LINES & RGB SLICE ===== */
/* We render quick scanlines over the sprite using ::after, and a chroma offset using ::before */
#ghost .sprite { position: relative; overflow: visible; }

/* scanline pass – denser + brighter sweep */
#ghost .sprite::after{
  content:"";
  position:absolute; inset:-8%;
  pointer-events:none;
  mix-blend-mode:screen;
  opacity:0;
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(255,  40,150, .00) 0   4px,
      rgba(255,  40,150, .16) 4px 5px,
      rgba( 30, 220,255, .00) 5px 10px
    );
  filter: blur(.35px) saturate(1.35);
}
/* Punchier colour-glitch sweep (keeps your existing toggles) */
#ghost.glitch .sprite::after{
  opacity:.95;
  animation: ghostScan 180ms linear 1;
}
@keyframes ghostScan{
  0%   { transform: translateY(-35%); }
  100% { transform: translateY(135%); }
}
#ghost.glitch .sprite::before{
  opacity:1;
  animation: ghostSlice 150ms steps(2,end) 1;
}
@keyframes ghostSlice{
  0%  { transform: translate(1.6px,-1.2px) skewX(1.2deg); }
  50% { transform: translate(-1.6px,1.2px) skewX(-1.2deg); }
  100%{ transform: translate(0,0) }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){
  #ghost .idle-bob, #ghost .idle-tilt { animation: none; }
}
/* ————— ELECTRIC INTRO OVERLAY ————— */
#ghost .electric-intro{
  position:absolute; left:50%; top:50%;
  transform:translate(-50%, -50%);
  width: min(34vw, 420px);
  height: min(34vw, 420px);
  pointer-events:none;
  z-index: 40;                  /* above sprite and speech bubble */
  mix-blend-mode: screen;       /* pops on dark bg */
  filter: drop-shadow(0 0 20px rgba(120,200,255,.35));
}

/* subtle glow on the ghost body while charging */
#ghost.charging .sprite{
  filter:
    drop-shadow(0 0 24px rgba(120,200,255,.35))
    drop-shadow(0 0 40px rgba(120,200,255,.20));
}

/* waveform dash animate */
@keyframes dashFlow {
  0%   { stroke-dashoffset: 0; }
  100% { stroke-dashoffset: -600; }
}

/* bolt flicker scale/jitter */
@keyframes boltPulse {
  0%, 100% { opacity: .85; transform: translate(-50%, -50%) scale(1); }
  50%      { opacity: 1;    transform: translate(-50%, -50%) scale(1.03); }
}

/* post-birth settle shimmer */
@keyframes settleGlow {
  0% { filter: drop-shadow(0 0 34px rgba(120,200,255,.35)); }
  100%{ filter: drop-shadow(0 0 10px rgba(120,200,255,.12)); }
}




@keyframes ghostBob   { 0%,100%{ transform: translateY(0) } 50%{ transform: translateY(-7px) } }
@keyframes ghostBreathe{
  0%,100%{ transform: scaleY(1) }
  50%{ transform: scaleY(0.985) }
}
@keyframes ghostTilt  { 0%,100%{ transform: rotate(0deg) } 50%{ transform: rotate(-1.2deg) } }

/* both faces live in the same spot; we just fade between them */
#ghost .face { animation: faceDrift 7.2s ease-in-out infinite; }
@keyframes faceDrift { 0%,100% { transform: translateX(0) } 50% { transform: translateX(1.4px) } }

#ghost .face-evil { opacity: 0; }
#ghost.evil .face-normal { opacity: 0; }
#ghost.evil .face-evil   { opacity: 1; }

/* blink (subtle/desynced) */
#ghost .eye{
  transform-origin:center; transform-box: fill-box;
  animation: eyeBlink 6.2s steps(1,end) infinite;
}
@keyframes eyeBlink{
  0%, 92%, 100% { transform: scaleY(1) }
  93%          { transform: scaleY(0.12) }
  94%          { transform: scaleY(1) }
}
#ghost .eye:nth-of-type(2){ animation-delay: 1.4s; }
@keyframes eyeBlink{
  0%, 92%, 100% { transform: scaleY(1) }
  93%          { transform: scaleY(0.15) }
  94%          { transform: scaleY(1) }
}

/* talk while speaking */
#ghost.speaking .mouth{
  transform-origin:center; transform-box:fill-box;
  animation: talk 150ms ease-in-out infinite;
}
@keyframes talk{ 0%,100%{ transform: scaleY(0.35) } 50%{ transform: scaleY(0.9) } }

/* RGB glitch edge bursts (class toggled in JS) */
#ghost.glitch .sprite{
  filter:
    drop-shadow( 2px -1px rgba(255,32,96,.35))
    drop-shadow(-2px  1px rgba( 32,210,255,.35));
  animation: ghostGlitch 180ms steps(2,end) 1;
}
@keyframes ghostGlitch{
  0%{ transform: translate( .5px, -.5px) skewX(.6deg) }
  50%{ transform: translate(-.5px,  .5px) skewX(-.6deg) }
  100%{ transform: translate(0,0) }
}

/* speech bubble: readable + tail */
/* ---------- Speech bubble (glass, readable, closer) ---------- */
#ghost .bubble{
  /* layout */
  position: absolute;
  left: 50%;
   top: calc(100% + 2px);    /* closer: was 12px */
  transform: translateX(-50%);
  max-width: clamp(720px, 86vw, 1120px);  

  /* look */
  --bubble-bg1: rgba(16,22,32,0.92);
  --bubble-bg2: rgba(10,14,22,0.90);
  --ring: rgba(255,255,255,0.12);
  --inner: rgba(255,255,255,0.06);

  background: linear-gradient(180deg, var(--bubble-bg1), var(--bubble-bg2));
  color: #e8edf8;
  border: 1px solid var(--ring);
  border-radius: 16px;
   padding: 14px 28px;   
  text-align: center;

  /* type */
  font: 16px/1.45 ui-sans-serif, system-ui, "Segoe UI", Roboto, sans-serif; /* slightly tighter */
  letter-spacing: .1px; 
    text-wrap: balance; 
  white-space: pre-wrap;               /* keep your line breaks */
  text-shadow: 0 1px 0 rgba(0,0,0,0.35);

  /* glass + depth */
  backdrop-filter: blur(8px) saturate(120%);
  box-shadow:
    0 10px 28px rgba(0,0,0,.42),
    inset 0 1px 0 var(--inner);

  /* show/hide */
  opacity: 0;
  transform-origin: 50% -8px;          /* scale from tail */
  transition:
    opacity 340ms ease,
    box-shadow 340ms ease,
    border-color 340ms ease,
    background-color 340ms ease;
}

/* tail (with subtle rim) */
#ghost .bubble::before,
#ghost .bubble::after{
  content:"";
  position:absolute; left:50%;
  transform: translateX(-50%);
  pointer-events:none;
}
#ghost .bubble::before{
  top:-8px;
  border-left:9px solid transparent;
  border-right:9px solid transparent;
  border-bottom:9px solid rgba(16,22,32,0.92);   /* matches bg */
  filter: drop-shadow(0 -1px 0 rgba(255,255,255,0.10));
}
#ghost .bubble::after{                /* tiny inner highlight at base */
  top:-1px; width:52px; height:2px;
  background: radial-gradient(50% 120% at 50% 0%,
              rgba(255,255,255,0.10), transparent 70%);
  border-radius: 2px;
}

/* visibility states (no movement of ghost) */
#ghost .bubble.show{ opacity:1; }
#ghost .bubble.hide{ opacity:0; }

/* typing hesitation (kept) */
#ghost .bubble.typing::after{
  content:' …';
  animation:dots 1.2s steps(3,end) infinite;
}
@keyframes dots{
  0%{content:' .'} 33%{content:' ..'} 66%{content:' ...'} 100%{content:' .'}
}

/* optional word wobble + rgb edge (kept) */
@keyframes wobble{
  0%{transform:translateY(0) rotate(0)}
  20%{transform:translateY(-1px) rotate(-1.2deg)}
  40%{transform:translateY(1px) rotate(1.2deg)}
  60%{transform:translateY(-.5px) rotate(-.8deg)}
  80%{transform:translateY(.5px) rotate(.8deg)}
  100%{transform:translateY(0) rotate(0)}
}
.wobble{ animation:wobble 420ms ease-in-out infinite; }
.wordWrap.rgbWord::before,
.wordWrap.rgbWord::after{
  content: attr(data-word);
  position:absolute; inset:0; pointer-events:none;
  mix-blend-mode:screen;
  opacity:.9; filter: blur(.8px) saturate(1.35);
}
.wordWrap.rgbWord::before{ color:#ff2a6d; transform:translate(6px,-3px) skewX(6deg) }
.wordWrap.rgbWord::after { color:#2ad4ff; transform:translate(-6px,3px)  skewX(-6deg) }

/* reduced motion */
@media (prefers-reduced-motion: reduce){
  #ghost .bubble{ transition-duration: 0.001ms !important; }
  .wobble{ animation: none !important; }
}


/*SPEECH BUBBLE MOOD TEXT*/
/* hesitant: dimmer, cooler ring */
#ghost[data-mood="hesitant"] .bubble{
  --ring: rgba(180,200,255,0.14);
  box-shadow:
    0 10px 26px rgba(0,0,0,.42),
    inset 0 1px 0 rgba(255,255,255,0.05);
  opacity: .92;
}

/* perform: brighter, sharper ring + glow */
#ghost[data-mood="perform"] .bubble{
  --ring: rgba(220,238,255,0.22);
  box-shadow:
    0 14px 34px rgba(10,30,60,.55),
    0 0 24px rgba(160,210,255,0.10),
    inset 0 1px 0 rgba(255,255,255,0.08);
  background: linear-gradient(180deg,
              rgba(22,28,40,0.95),
              rgba(12,18,30,0.94));
}

/* glitch: add chromatic fringe + micro-noise */
#ghost[data-mood="glitch"] .bubble{
  --ring: rgba(255,120,180,0.22);
  box-shadow:
    0 12px 30px rgba(20,0,30,.55),
    0 0 20px rgba(120,180,255,0.10),
    inset 0 1px 0 rgba(255,255,255,0.07);
  position: relative;
}
#ghost[data-mood="glitch"] .bubble::after{
  /* subtle RGB fringing around the bubble edge */
  content:""; position:absolute; inset:-1px; border-radius:16px;
  pointer-events:none;
  box-shadow:
    1px -1px 0 0 rgba(255,90,160,0.25),
   -1px  1px 0 0 rgba(90,200,255,0.25);
  mix-blend-mode: screen;
}

/* honest: softer, cooler tint */
#ghost[data-mood="honest"] .bubble{
  --ring: rgba(180,210,255,0.16);
  background: linear-gradient(180deg,
              rgba(14,20,30,0.94),
              rgba(10,14,22,0.92));
  box-shadow:
    0 10px 26px rgba(0,0,0,.42),
    inset 0 1px 0 rgba(255,255,255,0.06);
}

/* handoff: gently dim to let fragments take over */
#ghost[data-mood="handoff"] .bubble{
  opacity: .86;
  --ring: rgba(180,200,240,0.12);
  box-shadow:
    0 8px 20px rgba(0,0,0,.38),
    inset 0 1px 0 rgba(255,255,255,0.05);
}
