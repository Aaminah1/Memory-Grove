/* ----- ghost container under the title ----- */
#ghost{
  position: fixed;
  left: 50%;
  top: clamp(110px, 30vh, 280px);
  transform: translateX(-50%);
  color: #e7ebf4;
  opacity: 0;
  transition: opacity 700ms ease, transform 900ms cubic-bezier(.2,.9,.1,1);
  pointer-events: none;
  z-index: 20;
}
#ghost.on{ opacity:1; transform: translateX(-50%) }

/* sprite size + idle life */
#ghost .sprite{
  width: clamp(120px, 14vw, 178px);
  height: auto;
  z-index:1;
  opacity: 0; transition: opacity 380ms ease;
  /* alive: slow bob + tiny breathe + tilt */
  animation:
    ghostBob 6.4s ease-in-out infinite,
    ghostBreathe 5.2s ease-in-out infinite,
    ghostTilt 11s ease-in-out infinite;
  filter: drop-shadow(0 8px 24px rgba(255,255,255,.08));
}
#ghost.ready .sprite { opacity: 1; }

/* entrance canvas */
#ghost canvas.assemble {
  position: absolute; inset: 2;
  width: 140px; height: 170px;
  margin: auto;
  filter: blur(.2px);
  pointer-events: none;
}

@keyframes ghostBob   { 0%,100%{ transform: translateY(0) } 50%{ transform: translateY(-7px) } }
@keyframes ghostBreathe{
  0%,100%{ transform: scaleY(1) }
  50%{ transform: scaleY(0.985) }
}
@keyframes ghostTilt  { 0%,100%{ transform: rotate(0deg) } 50%{ transform: rotate(-1.2deg) } }

/* both faces live in the same spot; we just fade between them */
#ghost .face { transition: opacity 160ms ease; }
#ghost .face-evil { opacity: 0; }
#ghost.evil .face-normal { opacity: 0; }
#ghost.evil .face-evil   { opacity: 1; }

/* blink (subtle/desynced) */
#ghost .eye{
  transform-origin:center; transform-box: fill-box;
  animation: eyeBlink 6.8s steps(1,end) infinite;
}
#ghost .eye:nth-of-type(2){ animation-delay: 1.4s; }
@keyframes eyeBlink{
  0%, 92%, 100% { transform: scaleY(1) }
  93%          { transform: scaleY(0.15) }
  94%          { transform: scaleY(1) }
}

/* talk while speaking */
#ghost.speaking .mouth{
  transform-origin:center; transform-box:fill-box;
  animation: talk 150ms ease-in-out infinite;
}
@keyframes talk{ 0%,100%{ transform: scaleY(0.35) } 50%{ transform: scaleY(0.9) } }

/* RGB glitch edge bursts (class toggled in JS) */
#ghost.glitch .sprite{
  filter:
    drop-shadow( 2px -1px rgba(255,32,96,.35))
    drop-shadow(-2px  1px rgba( 32,210,255,.35));
  animation: ghostGlitch 180ms steps(2,end) 1;
}
@keyframes ghostGlitch{
  0%{ transform: translate( .5px, -.5px) skewX(.6deg) }
  50%{ transform: translate(-.5px,  .5px) skewX(-.6deg) }
  100%{ transform: translate(0,0) }
}

/* speech bubble: readable + tail */
#ghost .bubble{
  position:absolute;
  left:50%; top: calc(100% + 12px);
  transform: translateX(-50%);
  background: rgba(16,22,32,.90);
  color:#e6ebf7;
  border:1px solid rgba(255,255,255,.12);
  border-radius: 14px;
  padding: 14px 16px;
  font: 15px/1.5 ui-sans-serif, system-ui, Segoe UI, Roboto, sans-serif;
  max-width: min(540px, 76vw);
  text-align:center;
  box-shadow:
    0 8px 24px rgba(0,0,0,.35),
    inset 0 1px 0 rgba(255,255,255,.06);
  opacity:0;
  transition: opacity 260ms ease;
  pointer-events:none;
}
#ghost .bubble::before{
  content:"";
  position:absolute; left:50%; top:-9px; transform: translateX(-50%);
  border-left:8px solid transparent;
  border-right:8px solid transparent;
  border-bottom:9px solid rgba(16,22,32,.90);
  filter: drop-shadow(0 -1px 0 rgba(255,255,255,.12));
}
#ghost .bubble.show{ opacity:1 }
#ghost .bubble.hide{ opacity:0 }

/* typing ellipsis for hesitation */
#ghost .bubble.typing::after{
  content:' â€¦';
  animation:dots 1.2s steps(3,end) infinite;
}
@keyframes dots{ 0%{content:' .'} 33%{content:' ..'} 66%{content:' ...'} 100%{content:' .'} }

/* swapped word wobble + RGB edge */
@keyframes wobble {
  0%   { transform: translateY(0) rotate(0deg) }
  20%  { transform: translateY(-1px) rotate(-1.2deg) }
  40%  { transform: translateY(1px) rotate(1.2deg) }
  60%  { transform: translateY(-0.5px) rotate(-0.8deg) }
  80%  { transform: translateY(0.5px) rotate(0.8deg) }
  100% { transform: translateY(0) rotate(0deg) }
}
.wobble { animation: wobble 420ms ease-in-out infinite; }
.wordWrap.rgbWord::before,
.wordWrap.rgbWord::after{
  content: attr(data-word);
  position:absolute; inset:0; pointer-events:none;
  mix-blend-mode:screen;
  opacity:.9; filter: blur(.8px) saturate(1.35);
}
.wordWrap.rgbWord::before{ color:#ff2a6d; transform:translate(6px,-3px) skewX(6deg) }
.wordWrap.rgbWord::after { color:#2ad4ff; transform:translate(-6px,3px)  skewX(-6deg) }
