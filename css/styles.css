/* Reset + base */
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  background: #0e0f14; color: #e6e6e6; line-height: 1.5;
}

/* Header */
/* Header */
.site-header {
  position: sticky;
  top: 0;
  z-index: 40;

  display: flex;
  justify-content: space-between;
  align-items: center;

  padding: 0.75rem 1.25rem;
  background:
    radial-gradient(900px 520px at 50% 0%, #181a23 0%, #0e0f16 55%, #080811 100%);
  border-bottom: 1px solid rgba(255,255,255,0.06);

  /* for the glitch line ::after */
  overflow: hidden;
}

/* subtle moving RGB “scan line” under the navbar */
.site-header::after {
  content: "";
  position: absolute;
  left: -20%;
  right: -20%;
  bottom: 0;
  height: 1px;
  pointer-events: none;
  mix-blend-mode: screen;

  background: linear-gradient(
    90deg,
    rgba(255,42,109,.0) 0%,
    rgba(255,42,109,.65) 18%,
    rgba(42,212,255,.8) 40%,
    rgba(120,255,180,.8) 60%,
    rgba(42,212,255,.65) 82%,
    rgba(255,42,109,.0) 100%
  );
  background-size: 250% 100%;
  opacity: .55;

  animation: headerGlitchSweep 6.2s linear infinite;
}

@keyframes headerGlitchSweep {
  0%   { background-position: 0% 0;   opacity:.20; }
  25%  { background-position: 40% 0;  opacity:.55; }
  50%  { background-position: 100% 0; opacity:.70; }
  75%  { background-position: 40% 0;  opacity:.55; }
  100% { background-position: 0% 0;   opacity:.20; }
}

/* Brand → same vibe as intro title */
.site-header .brand{
  margin:0;
  font-family:"Cinzel", ui-serif, Georgia, serif;
  font-weight:700;
  letter-spacing:.06em;
  text-transform:uppercase;
  font-size: clamp(16px, 2.4vw, 22px);
  line-height:1;
}
.site-header h1.brand {
  font-size: 1.05rem;
  text-transform: uppercase;
  letter-spacing: .18em;
}

/* brand looks like clean text but has RGB “ghost” on hover */
.site-header .brand-link {
  position: relative;
  color: #e7ebf4;
  text-decoration: none;
  font-family: "Cinzel", ui-serif, Georgia, serif;
  text-transform: uppercase;
  letter-spacing: .18em;
  padding: .1rem .15rem;
}

.site-header .brand-link::before,
.site-header .brand-link::after {
  content: attr(data-label);
  position: absolute;
  inset: 0;
  pointer-events: none;
  mix-blend-mode: screen;
  opacity: 0;
  filter: blur(.7px) saturate(1.3);
  transition: opacity .18s ease;
}

/* magenta / cyan split like the title letters */
.site-header .brand-link::before {
  color: #ff2a6d;
  transform: translate(3px,-2px) skewX(4deg);
}
.site-header .brand-link::after {
  color: #2ad4ff;
  transform: translate(-3px,2px) skewX(-4deg);
}

/* on hover: quick “wobble” glitch, then settle */
.site-header .brand-link:hover::before,
.site-header .brand-link:hover::after {
  opacity: .95;
  animation: brandGlitch 420ms steps(2,end) 1;
}

@keyframes brandGlitch {
  0%   { clip-path: inset(0 0 65% 0); }
  45%  { clip-path: inset(35% 0 0 0); }
  100% { clip-path: inset(0 0 0 0); }
}

/* focus-visible: accessible but still on-theme */
.site-header .brand-link:focus-visible {
  outline: none;
  box-shadow:
    0 0 0 2px rgba(10,14,22,1),
    0 0 0 4px rgba(42,212,255,0.6);
  border-radius: 4px;
}

.site-header .brand-link{
  color: #e7ebf4;
  text-decoration:none;
  text-shadow: 0 0 18px rgba(190,210,255,.08);
}
.site-header .brand-link:hover{ opacity:.9; }
.site-header .brand-link:focus-visible{
  outline: 2px solid #8aa0ff; outline-offset: 2px; border-radius: 4px;
}
.tab.ghost {
  background: rgba(16,20,30,.55);
  color: #e7ebf4;
  position: relative;
  overflow: hidden;
}

/* glitch split */
.tab.ghost::before,
.tab.ghost::after {
  content: attr(data-label);
  position: absolute;
  inset: 0;
  pointer-events: none;
  mix-blend-mode: screen;
  opacity: 0;
}

.tab.ghost:hover::before {
  color: #ff2a6d;
  opacity: .95;
  transform: translate(2px,-1px) skewX(3deg);
  animation: tabGlitch 420ms steps(2,end) 1;
}

.tab.ghost:hover::after {
  color: #2ad4ff;
  opacity: .95;
  transform: translate(-2px,1px) skewX(-3deg);
  animation: tabGlitch 420ms steps(2,end) 1;
}

@keyframes tabGlitch{
  0%{   clip-path: inset(0 0 62% 0) }
  50%{  clip-path: inset(38% 0 0 0) }
  100%{ clip-path: inset(0 0 0 0)  }
}

/* --- “Your Grove” (primary variant) → green lift on hover, white text --- */
.site-nav .tab.primary{
  background: linear-gradient(180deg, #e7ebf4, #cfd9f7);
  color:#0b0d13;
  border-color: rgba(255,255,255,.85);
  transition:
    transform .18s cubic-bezier(.2,.8,.2,1),
    background .25s ease,
    color .25s ease,
    border-color .25s ease,
    box-shadow .25s ease;
}
.site-nav .tab.primary:hover{
  color:#ffffff;
  transform: translateY(-1px) scale(1.02);
  background: linear-gradient(180deg, #39cc85, #1f8e5a);
  border-color: rgba(44,162,103,.95);
  box-shadow:
    0 0 0 1px rgba(255,255,255,.06) inset,
    0 12px 28px rgba(0,0,0,.38);
}
.site-nav .tab.primary:active{
  transform: translateY(0) scale(0.995);
  background: linear-gradient(180deg, #1f8e5a, #176a45);
  border-color: rgba(5,138,8,.95);
}

/* Focus rings for accessibility */
.site-nav .tab.primary:focus-visible{
  outline: none;
  box-shadow:
    0 0 0 2px rgba(10,14,22,1),
    0 0 0 4px rgba(13,139,4,.55);
}
.site-nav .tab.ghost:focus-visible{
  outline: 2px solid #8aa0ff;
  outline-offset: 2px;
  border-radius: 999px;
}

/* Optional: make the currently selected tab look pressed/active */
.site-nav .tab.is-active{
  background: linear-gradient(180deg, rgba(40,46,66,.92), rgba(30,36,54,.92));
  color:#e9edf7;
  border-color: rgba(255,255,255,.22);
}
/* Nav layout */
.site-nav{ display:flex; align-items:center; gap:10px; }

.site-footer{
  position: fixed;
  left: 0; right: 0; bottom: 0;
  height: var(--footerH);
  display: flex; align-items: center; justify-content: center;
  padding: 10px 16px;
  z-index: 50; /* above veils and background FX */

  /* subtle frosted strip that blends with your dark gradient */
  background:
    linear-gradient(180deg, rgba(8,10,16,0.00) 0%,
                           rgba(8,10,16,0.55) 28%,
                           rgba(5,6,10,0.88) 100%);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  border-top: 1px solid rgba(255,255,255,.08);
  box-shadow: 0 -10px 30px rgba(0,0,0,.35);
  pointer-events: auto; /* keep links clickable */

  /* respect device notches */
  padding-bottom: max(10px, env(safe-area-inset-bottom));
}

.site-footer small{
  color: var(--muted);
  font: 500 12px/1.4 ui-sans-serif, system-ui, Segoe UI, Roboto, sans-serif;
  letter-spacing: .02em;
  opacity: .9;
}
nav { display:flex; gap:.5rem; }
.tab{
  --ring: rgba(150,180,255,.35);
  display:inline-flex; align-items:center; gap:.5rem;
  padding:.55rem .95rem;
  border-radius:10px;
  font: 600 13.5px/1 ui-sans-serif, system-ui, Segoe UI, Roboto, sans-serif;
  letter-spacing:.02em;
  cursor:pointer;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(0, 0, 0, 0.65);
  color:#e9edf7;
  transition: background .18s ease, border-color .18s ease, transform .06s ease;
}
.tab:hover{ background: rgba(30,36,52,.78); }
.tab:active{ transform: translateY(1px); }
.tab.is-active{
  background: linear-gradient(180deg, rgba(40,46,66,.92), rgba(30,36,54,.92));
  border-color: rgba(255,255,255,.22);
  box-shadow: 0 0 0 0 var(--ring);
  animation: tabPulse 1.6s ease-out 1;
}
@keyframes tabPulse{
  0%{ box-shadow: 0 0 0 0 var(--ring); }
  100%{ box-shadow: 0 0 0 18px rgba(150,180,255,0); }
}

/* Variants to mirror intro palette */
.tab.primary{
  background: linear-gradient(180deg, #e7ebf4, #cfd9f7);
  color:#0b0d13;
  border-color: rgba(255,255,255,.85);
}
.tab.primary:hover{ filter: brightness(.98); }

/* Badge style stays, just polish a little */
.badge{
  display:inline-block; min-width:1.25rem; padding:0 .38rem;
  margin-left:.4rem;
  font-size:.72rem; line-height:1.25rem; text-align:center;
  color:#0e0f14; background:#c9a806; border-radius:999px; font-weight:800;
  box-shadow: 0 0 12px rgba(201,168,6,.28);
}
/* Panels */
main { padding:1rem; max-width:900px; margin:auto; }
.panel { margin-top:1rem; }
.help { color:#aab0bb; font-size:.92rem; margin-top:.35rem; }
#groveSection.panel { max-width: min(1400px, 96vw); margin-inline:auto; }

/* Stepper */
.stepper { display:flex; align-items:center; gap:.35rem; color:#9aa1ad; font-size:.9rem; }
.stepper .step.active { color:#e6e6e6; font-weight:600; }
.stepper .sep { opacity:.4; }

/* Nudge bar */
.nudge {
  margin-top:.5rem; padding:.5rem .7rem;
  background:#12141c; border:1px solid #2a2b33; border-radius:10px; color:#d9dce2;
}
.linky {
  background:transparent; border:none; color:#8aa0ff; text-decoration:underline; cursor:pointer;
  padding:0 .15rem;
}
.linky:hover { opacity:.85; }

/* Ask row */
.ask-row { display:grid; gap:.6rem; grid-template-columns: 1fr auto; align-items:start; }
textarea {
  width:100%; min-height:72px; padding:.6rem;
  background:#10121a; border:1px solid #2a2b33; border-radius:10px; color:#fff;
}
/* Character counter */
#qCount {
  font-size: 0.85rem;
  color: #9aa0aa;
}
#qCount.limit {
  color: #e5534b;           /* turns red at max */
  font-weight: 600;
}

button {
  background:#2a2d3a; border:1px solid #2a2b33; color:#e6e6e6;
  padding:.55rem 1rem; border-radius:10px; cursor:pointer; transition:.15s ease;
}
button:hover { background:#3a3e52; }
button:active { transform: translateY(1px); }
button[disabled] { opacity:.6; cursor:not-allowed; }

/* Tombstone (reply) */
.tombstone {
  margin-top:1rem; padding:1rem; border-radius:18px;
  background:#14151c; border:1px solid #2a2b33; position:relative; overflow:hidden;
}
.grave-top { display:flex; align-items:center; gap:.6rem; margin-bottom:.5rem; }
.grave-icon { font-size:1.4rem; filter: drop-shadow(0 0 6px rgba(255,255,255,.06)); }
.grave-inscription { font-variant:small-caps; letter-spacing:.08em; color:#bfbfbf; text-shadow:0 1px 0 rgba(0,0,0,.4); }
.tombstone p { margin-top:.4rem; color:#d7d7d7; }

/* subtle candle glow */
.tombstone::after {
  content:""; position:absolute; top:-30px; left:50%; transform:translateX(-50%);
  width:200px; height:60px; border-radius:50%;
  background: radial-gradient(ellipse at center, rgba(255,240,200,.15), transparent 60%);
  animation: flicker 3.8s ease-in-out infinite; pointer-events:none;
}
@keyframes flicker { 0%,100%{opacity:.35; transform:translateX(-50%) scale(1);} 50%{opacity:.15; transform:translateX(-50%) scale(1.05);} }

/* Skeleton */
.skeleton { margin-top:.25rem; }
.shimmer { height:12px; border-radius:6px; background:#1a1c25; overflow:hidden; position:relative; }
.shimmer::after {
  content:""; position:absolute; inset:0;
  background:linear-gradient(90deg, transparent, rgba(255,255,255,.06), transparent);
  animation: shimmer 1200ms infinite;
}
.shimmer.line { margin-top:.4rem; }
.shimmer.line.short { width:60%; }
@keyframes shimmer { 0%{transform:translateX(-100%);} 100%{transform:translateX(100%);} }

/* Error box */
.error {
  margin-top:.5rem; background:#2b1d1f; color:#ffdede;
  border:1px solid #e5534b; border-radius:10px; padding:.55rem .7rem;
}

/* Classification */
.classify { margin-top:1rem; }
.classify-row { display:flex; gap:.5rem; margin:.35rem 0 .6rem; }
.classify button[data-class="green"] { background:#234f2e; border-color:#3fb950; color:#dfffe9; }
.classify button[data-class="green"].active { background:#2ea043; border-color:#2ea043; }
.classify button[data-class="yellow"] { background:#4f4a23; border-color:#c9a806; color:#fff7d1; }
.classify button[data-class="yellow"].active { background:#c9a806; border-color:#c9a806; color:#222; }
.classify button[data-class="red"] { background:#4f2323; border-color:#e5534b; color:#ffe1df; }
.classify button[data-class="red"].active { background:#e5534b; border-color:#e5534b; color:#fff; }

/* Action bar */
.action-bar { display:flex; align-items:center; gap:.5rem; margin-top:.6rem; position:sticky; bottom:.5rem; }
.chip { background:#1b1d26; border:1px solid #2a2b33; padding:.25rem .5rem; border-radius:999px; font-size:.85rem; color:#cfd2d8; }

/* ------ GROVE (graveyard area) ------ */
.grove-toolbar { display:flex; align-items:center; gap:.5rem; margin:.5rem 0; }
.grove-toolbar .filter-btn {
  background:#22242e; border:1px solid #2a2b33; padding:.35rem .7rem; border-radius:999px; font-size:.9rem; cursor:pointer;
}
.grove-toolbar .filter-btn[aria-pressed="true"] { background:#3b3f52; }
/* let clicks pass through the inscription block */
#groveCanvas foreignObject,
#groveCanvas .stone-inscription {
  pointer-events: none;
}

/* (optional) also let overlays pass clicks through */
#groveCanvas image.overlay {
  pointer-events: none;
}





/* Hint under the grove */
.hint { color:#9aa0aa; margin-top:.5rem; font-size:.9rem; }

/* Stones/labels/halos */
.stone:hover { filter: brightness(1.05); }
.stone-halo.green  { stroke:#7bd389; }
.stone-halo.yellow { stroke:#e1d97a; }
.stone-halo.red    { stroke:#ee8a8a; }

/* Type-to-reveal classify */
#classifyBox[hidden]{display:none;}
#classifyBox{opacity:0;transition:opacity .25s ease;}
#classifyBox:not([hidden]){opacity:1;}

/* A11y utility */
.visually-hidden {
  position:absolute !important; height:1px; width:1px; overflow:hidden;
  clip: rect(1px,1px,1px,1px); white-space:nowrap;
}

/* Mobile tweaks */
@media (max-width: 640px) {
  .ask-row { grid-template-columns: 1fr; }
  button { padding:.6rem .85rem; }
  #groveSection.panel { max-width: 100vw; }
  .grove-frame { height: calc(100vh - 260px); min-height: 420px; }
}
/* Make ONLY the Grove section full-bleed across the page */
#groveSection.panel {
  width: 100vw;
  max-width: 100vw;
  margin-left: 50%;
  transform: translateX(-50%);
  padding-inline: clamp(12px, 4vw, 32px);
}

/* Big responsive graveyard area */
.grove-frame {
  margin-top: .75rem;
  background: #0f1117;
  border: 1px solid #2a2b33;
  border-radius: 14px;

  /* keep clipping, but add real inner space */
  overflow: hidden;
  padding: 72px 40px 72px;    box-sizing: border-box;    /* ← so the padding doesn't grow the visual height */

  width: 100%;
  height: calc(100vh - 160px);
  min-height: 720px;
}

/* make the SVG fill the padded box cleanly */
.grove-frame > svg#groveCanvas {
  display: block;
  width: 100%;
  height: 100%;
}


/* Let SVG stretch to the frame */
#groveCanvas { width: 100%; height: 100%; display: block; }

/* Labels (if you kept them) */

/* If you still have halo elements and want them invisible anyway */
.stone-halo { opacity: 0 !important; }
/* Inscription text inside each tombstone */
/* text that sits inside the tombstone */
.stone-inscription {
  width:100%; height:100%;
  display:flex; align-items:center; justify-content:center;
  text-align:center;
  line-height:1.2;
  padding:8px 10px;     /* add extra breathing room */
  color:#1e2026;
  overflow:hidden;
  word-break:break-word;
  hyphens:auto;

  display:-webkit-box;
  -webkit-box-orient:vertical;
  -webkit-line-clamp:3;
}


/* ===== App page right-side ghost ===== */
.app-ghost{
  position:absolute;
  right: min(2vw, 24px);
  top: 120px;                     /* tuned for your header */
  transform: translateY(0);
  color:#e7ebf4;
  opacity:0;
  pointer-events:none;
  transition: opacity 400ms ease, transform 600ms cubic-bezier(.2,.9,.1,1);
  z-index: 30;
}

/* show state */
.app-ghost.on{ opacity:.95 }

/* size like your main ghost */
.app-ghost .sprite{ 
  width: clamp(140px, 22vw, 280px);
  margin-left:auto;
  filter: drop-shadow(0 10px 24px rgba(0,0,0,.45));
}

/* reuse the idle animations & face/mouth hooks from your ghost styles */
.app-ghost .eye{ animation: eyeBlink var(--blinkDur, 4.2s) steps(1,end) infinite; }
.app-ghost .mouth{ transform-origin:center; transform-box:fill-box; }

/* bubble: reuse your .bubble look; nudge closer */
/* Alias mg-bubble to bubble styles */
.app-ghost .mg-bubble{ 
  position:absolute;
  left: calc(100% + 12px);
  top: 12px;
  transform: translateY(0);
  background: linear-gradient(180deg, rgba(16,22,32,.96), rgba(10,14,22,.94));
  border:1px solid rgba(255,255,255,.15);
  color:#e8edf8;
  border-radius:14px;
  padding:10px 14px;
  font-size: clamp(12px,1.35vw,14px);
  line-height:1.35;
  max-width: clamp(220px, 32vw, 420px);
  white-space: normal;
  box-shadow: 0 10px 30px rgba(0,0,0,.35);
  opacity:0;
  pointer-events:none;
  transition: opacity .20s ease, transform .20s ease;
}
.app-ghost .mg-bubble::after{
  content:"";
  position:absolute; left:-8px; top:16px;
  border-right:8px solid rgba(16,22,32,.96);
  border-top:8px solid transparent;
  border-bottom:8px solid transparent;
}
.app-ghost .mg-bubble.show{ opacity:1; transform: translateY(-2px); }
.app-ghost .mg-bubble.hide{ opacity:0; transform: translateY(0); }

/* mobile alias */
@media (max-width: 900px){
  .app-ghost .mg-bubble{
    left:50%; top: calc(100% + 8px); transform: translate(-50%, 0);
    max-width: min(92vw, 560px);
  }
  .app-ghost .mg-bubble::after{
    left:50%; top:-8px; transform: translateX(-50%);
    border-right:none;
    border-left:8px solid transparent;
    border-right:8px solid transparent;
    border-bottom:8px solid rgba(16,22,32,.96);
  }
}
