/* Reset + base */
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  background: #0e0f14; color: #e6e6e6; line-height: 1.5;
}

/* Header */
/* Header */
.site-header {
  position: sticky;
  top: 0;
  z-index: 40;

  display: flex;
  justify-content: space-between;
  align-items: center;

  padding: 0.75rem 1.25rem;
  background:
    radial-gradient(900px 520px at 50% 0%, #181a23 0%, #0e0f16 55%, #080811 100%);
  border-bottom: 1px solid rgba(255,255,255,0.06);

  /* for the glitch line ::after */
  overflow: hidden;
}

/* subtle moving RGB “scan line” under the navbar */
.site-header::after {
  content: "";
  position: absolute;
  left: -20%;
  right: -20%;
  bottom: 0;
  height: 1px;
  pointer-events: none;
  mix-blend-mode: screen;

  background: linear-gradient(
    90deg,
    rgba(255,42,109,.0) 0%,
    rgba(255,42,109,.65) 18%,
    rgba(42,212,255,.8) 40%,
    rgba(120,255,180,.8) 60%,
    rgba(42,212,255,.65) 82%,
    rgba(255,42,109,.0) 100%
  );
  background-size: 250% 100%;
  opacity: .55;

  animation: headerGlitchSweep 6.2s linear infinite;
}

@keyframes headerGlitchSweep {
  0%   { background-position: 0% 0;   opacity:.20; }
  25%  { background-position: 40% 0;  opacity:.55; }
  50%  { background-position: 100% 0; opacity:.70; }
  75%  { background-position: 40% 0;  opacity:.55; }
  100% { background-position: 0% 0;   opacity:.20; }
}

/* Brand → same vibe as intro title */
.site-header .brand{
  margin:0;
  font-family:"Cinzel", ui-serif, Georgia, serif;
  font-weight:700;
  letter-spacing:.06em;
  text-transform:uppercase;
  font-size: clamp(16px, 2.4vw, 22px);
  line-height:1;
}
.site-header h1.brand {
  font-size: 1.05rem;
  text-transform: uppercase;
  letter-spacing: .18em;
}

/* brand looks like clean text but has RGB “ghost” on hover */
.site-header .brand-link {
  position: relative;
  color: #e7ebf4;
  text-decoration: none;
  font-family: "Cinzel", ui-serif, Georgia, serif;
  text-transform: uppercase;
  letter-spacing: .18em;
  padding: .1rem .15rem;
}

.site-header .brand-link::before,
.site-header .brand-link::after {
  content: attr(data-label);
  position: absolute;
  inset: 0;
  pointer-events: none;
  mix-blend-mode: screen;
  opacity: 0;
  filter: blur(.7px) saturate(1.3);
  transition: opacity .18s ease;
}

/* magenta / cyan split like the title letters */
.site-header .brand-link::before {
  color: #ff2a6d;
  transform: translate(3px,-2px) skewX(4deg);
}
.site-header .brand-link::after {
  color: #2ad4ff;
  transform: translate(-3px,2px) skewX(-4deg);
}

/* on hover: quick “wobble” glitch, then settle */
.site-header .brand-link:hover::before,
.site-header .brand-link:hover::after {
  opacity: .95;
  animation: brandGlitch 420ms steps(2,end) 1;
}

@keyframes brandGlitch {
  0%   { clip-path: inset(0 0 65% 0); }
  45%  { clip-path: inset(35% 0 0 0); }
  100% { clip-path: inset(0 0 0 0); }
}

/* focus-visible: accessible but still on-theme */
.site-header .brand-link:focus-visible {
  outline: none;
  box-shadow:
    0 0 0 2px rgba(10,14,22,1),
    0 0 0 4px rgba(42,212,255,0.6);
  border-radius: 4px;
}

.site-header .brand-link{
  color: #e7ebf4;
  text-decoration:none;
  text-shadow: 0 0 18px rgba(190,210,255,.08);
}
.site-header .brand-link:hover{ opacity:.9; }
.site-header .brand-link:focus-visible{
  outline: 2px solid #8aa0ff; outline-offset: 2px; border-radius: 4px;
}
.tab.ghost {
  background: rgba(16,20,30,.55);
  color: #e7ebf4;
  position: relative;
  overflow: hidden;
}

/* glitch split */
.tab.ghost::before,
.tab.ghost::after {
  content: attr(data-label);
  position: absolute;
  inset: 0;
  pointer-events: none;
  mix-blend-mode: screen;
  opacity: 0;
}

.tab.ghost:hover::before {
  color: #ff2a6d;
  opacity: .95;
  transform: translate(2px,-1px) skewX(3deg);
  animation: tabGlitch 420ms steps(2,end) 1;
}

.tab.ghost:hover::after {
  color: #2ad4ff;
  opacity: .95;
  transform: translate(-2px,1px) skewX(-3deg);
  animation: tabGlitch 420ms steps(2,end) 1;
}

@keyframes tabGlitch{
  0%{   clip-path: inset(0 0 62% 0) }
  50%{  clip-path: inset(38% 0 0 0) }
  100%{ clip-path: inset(0 0 0 0)  }
}

/* --- “Your Grove” (primary variant) → green lift on hover, white text --- */
.site-nav .tab.primary{
  background: linear-gradient(180deg, #e7ebf4, #cfd9f7);
  color:#0b0d13;
  border-color: rgba(255,255,255,.85);
  transition:
    transform .18s cubic-bezier(.2,.8,.2,1),
    background .25s ease,
    color .25s ease,
    border-color .25s ease,
    box-shadow .25s ease;
}
.site-nav .tab.primary:hover{
  color:#ffffff;
  transform: translateY(-1px) scale(1.02);
  background: linear-gradient(180deg, #39cc85, #1f8e5a);
  border-color: rgba(44,162,103,.95);
  box-shadow:
    0 0 0 1px rgba(255,255,255,.06) inset,
    0 12px 28px rgba(0,0,0,.38);
}
.site-nav .tab.primary:active{
  transform: translateY(0) scale(0.995);
  background: linear-gradient(180deg, #1f8e5a, #176a45);
  border-color: rgba(5,138,8,.95);
}

/* Focus rings for accessibility */
.site-nav .tab.primary:focus-visible{
  outline: none;
  box-shadow:
    0 0 0 2px rgba(10,14,22,1),
    0 0 0 4px rgba(13,139,4,.55);
}
.site-nav .tab.ghost:focus-visible{
  outline: 2px solid #8aa0ff;
  outline-offset: 2px;
  border-radius: 999px;
}

/* Optional: make the currently selected tab look pressed/active */
.site-nav .tab.is-active{
  background: linear-gradient(180deg, rgba(40,46,66,.92), rgba(30,36,54,.92));
  color:#e9edf7;
  border-color: rgba(255,255,255,.22);
}
/* Nav layout */
.site-nav{ display:flex; align-items:center; gap:10px; }

.site-footer{
  position: fixed;
  left: 0; right: 0; bottom: 0;
  height: var(--footerH);
  display: flex; align-items: center; justify-content: center;
  padding: 10px 16px;
  z-index: 50; /* above veils and background FX */

  /* subtle frosted strip that blends with your dark gradient */
  background:
    linear-gradient(180deg, rgba(8,10,16,0.00) 0%,
                           rgba(8,10,16,0.55) 28%,
                           rgba(5,6,10,0.88) 100%);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  border-top: 1px solid rgba(255,255,255,.08);
  box-shadow: 0 -10px 30px rgba(0,0,0,.35);
  pointer-events: auto; /* keep links clickable */

  /* respect device notches */
  padding-bottom: max(10px, env(safe-area-inset-bottom));
}

.site-footer small{
  color: var(--muted);
  font: 500 12px/1.4 ui-sans-serif, system-ui, Segoe UI, Roboto, sans-serif;
  letter-spacing: .02em;
  opacity: .9;
}
nav { display:flex; gap:.5rem; }
.tab{
  --ring: rgba(150,180,255,.35);
  display:inline-flex; align-items:center; gap:.5rem;
  padding:.55rem .95rem;
  border-radius:10px;
  font: 600 13.5px/1 ui-sans-serif, system-ui, Segoe UI, Roboto, sans-serif;
  letter-spacing:.02em;
  cursor:pointer;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(0, 0, 0, 0.65);
  color:#e9edf7;
  transition: background .18s ease, border-color .18s ease, transform .06s ease;
}
.tab:hover{ background: rgba(30,36,52,.78); }
.tab:active{ transform: translateY(1px); }
.tab.is-active{
  background: linear-gradient(180deg, rgba(40,46,66,.92), rgba(30,36,54,.92));
  border-color: rgba(255,255,255,.22);
  box-shadow: 0 0 0 0 var(--ring);
  animation: tabPulse 1.6s ease-out 1;
}
@keyframes tabPulse{
  0%{ box-shadow: 0 0 0 0 var(--ring); }
  100%{ box-shadow: 0 0 0 18px rgba(150,180,255,0); }
}

/* Variants to mirror intro palette */
.tab.primary{
  background: linear-gradient(180deg, #e7ebf4, #cfd9f7);
  color:#0b0d13;
  border-color: rgba(255,255,255,.85);
}
.tab.primary:hover{ filter: brightness(.98); }

/* Badge style stays, just polish a little */
.badge{
  display:inline-block; min-width:1.25rem; padding:0 .38rem;
  margin-left:.4rem;
  font-size:.72rem; line-height:1.25rem; text-align:center;
  color:#0e0f14; background:#c9a806; border-radius:999px; font-weight:800;
  box-shadow: 0 0 12px rgba(201,168,6,.28);
}
/* Panels */
main { padding:1rem; max-width:900px; margin:auto; }
.panel { margin-top:1rem; }
.help { color:#aab0bb; font-size:.92rem; margin-top:.35rem; }
#groveSection.panel { max-width: min(1400px, 96vw); margin-inline:auto; }

/* Stepper — upgraded ritual bar */
.stepper {
  display: flex;
  align-items: center;
  gap: .3rem;
  font-size: .8rem;
  color: #9aa1ad;

  margin-top: .35rem;
  padding: .4rem .6rem;

  border-radius: 999px;
  background: radial-gradient(circle at 0% 0%, rgba(80,90,120,.23), rgba(8,10,18,.96));
  border: 1px solid rgba(255,255,255,.06);

  /* sit nicely above the tombstone, not too loud */
  max-width: 100%;
}

/* each step label */
.stepper .step {
  position: relative;
  padding: .25rem .6rem .25rem .9rem;
  border-radius: 999px;
  text-transform: uppercase;
  letter-spacing: .08em;
  font-weight: 500;
  opacity: .65;
  white-space: nowrap;
}

/* tiny numbered bullet before each step */
.stepper .step::before {
  content: attr(data-step); /* e.g. data-step="1" in HTML */
  position: absolute;
  left: .35rem;
  top: 50%;
  transform: translateY(-50%);
  width: .85rem;
  height: .85rem;
  border-radius: 999px;
  border: 1px solid rgba(180,190,230,.55);
  font-size: .65rem;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: .7;
}

/* separators (the arrows / dots between steps) */
.stepper .sep {
  opacity: .35;
  font-size: .7rem;
}

/* active step — glowing pill */
.stepper .step.active {
  opacity: 1;
  color: #e7ebf4;
  font-weight: 600;
  background: linear-gradient(120deg, rgba(42,212,255,.12), rgba(255,42,109,.06));
  box-shadow:
    0 0 0 1px rgba(150,180,255,.25),
    0 0 18px rgba(0,0,0,.45);
}

/* active step number glow */
.stepper .step.active::before {
  border-color: rgba(42,212,255,.9);
  background: radial-gradient(circle at 30% 30%, rgba(42,212,255,.9), rgba(10,12,24,1));
  color: #05070c;
  opacity: 1;
}

/* optional: different tint per phase if you want */
/* ask → cyan, read → violet, classify → amber, plant → green */

.stepper .step-ask.active {
  background: linear-gradient(120deg, rgba(42,212,255,.18), rgba(15,110,170,.35));
}

.stepper .step-read.active {
  background: linear-gradient(120deg, rgba(151,117,255,.22), rgba(60,40,120,.4));
}

.stepper .step-classify.active {
  background: linear-gradient(120deg, rgba(201,168,6,.22), rgba(120,90,20,.42));
}

.stepper .step-plant.active {
  background: linear-gradient(120deg, rgba(46,160,67,.24), rgba(15,80,40,.45));
}
/* === Soft metaphor “whisper” lines under headings === */

.metaphor-text {
  position: relative;
  display: inline-block;
  margin-top: 0.55rem;
  margin-bottom: 0.9rem;

  font-size: 0.9rem;
  font-style: italic;
  letter-spacing: 0.03em;
  color: #cfd3e6;
}

/* base underline shape */
.metaphor-text::after {
  content: "";
  position: absolute;
  left: 0;
  bottom: -0.25rem;
  width: 160px;
  height: 1px;
  pointer-events: none;
  opacity: 0.65;
}

/* ghost side: cold glitchy cyan/magenta hint */
.metaphor-text--ghost::after {
  background: linear-gradient(
    90deg,
    rgba(42, 212, 255, 0.8),
    rgba(255, 42, 109, 0.0)
  );
}

/* grove side: soft seed/plant green hint */
.metaphor-text--grove::after {
  background: linear-gradient(
    90deg,
    rgba(57, 204, 133, 0.9),
    rgba(57, 204, 133, 0.0)
  );
}

/* tiny hover shimmer, not a box */
.metaphor-text:hover::after {
  opacity: 1;
}

/* Nudge bar */
.nudge {
  margin-top:.5rem; padding:.5rem .7rem;
  background:#12141c; border:1px solid #2a2b33; border-radius:10px; color:#d9dce2;
}
.linky {
  background:transparent; border:none; color:#8aa0ff; text-decoration:underline; cursor:pointer;
  padding:0 .15rem;
}
.linky:hover { opacity:.85; }

/* Ask row */
.ask-row { display:grid; gap:.6rem; grid-template-columns: 1fr auto; align-items:start; }
textarea {
  width:100%; min-height:72px; padding:.6rem;
  background:#10121a; border:1px solid #2a2b33; border-radius:10px; color:#fff;
}
/* Character counter */
#qCount {
  font-size: 0.85rem;
  color: #9aa0aa;
}
#qCount.limit {
  color: #e5534b;           /* turns red at max */
  font-weight: 600;
}

button {
  background:#2a2d3a; border:1px solid #2a2b33; color:#e6e6e6;
  padding:.55rem 1rem; border-radius:10px; cursor:pointer; transition:.15s ease;
}
button:hover { background:#3a3e52; }
button:active { transform: translateY(1px); }
button[disabled] { opacity:.6; cursor:not-allowed; }

/* Tombstone (reply) */
.tombstone {
  margin-top:1rem; padding:1rem; border-radius:18px;
  background:#14151c; border:1px solid #2a2b33; position:relative; overflow:hidden;
}
.grave-top { display:flex; align-items:center; gap:.6rem; margin-bottom:.5rem; }
.grave-icon { font-size:1.4rem; filter: drop-shadow(0 0 6px rgba(255,255,255,.06)); }
.grave-inscription { font-variant:small-caps; letter-spacing:.08em; color:#bfbfbf; text-shadow:0 1px 0 rgba(0,0,0,.4); }
.tombstone p { margin-top:.4rem; color:#d7d7d7; }

/* subtle candle glow */
.tombstone::after {
  content:""; position:absolute; top:-30px; left:50%; transform:translateX(-50%);
  width:200px; height:60px; border-radius:50%;
  background: radial-gradient(ellipse at center, rgba(255,240,200,.15), transparent 60%);
  animation: flicker 3.8s ease-in-out infinite; pointer-events:none;
}
@keyframes flicker { 0%,100%{opacity:.35; transform:translateX(-50%) scale(1);} 50%{opacity:.15; transform:translateX(-50%) scale(1.05);} }

/* Skeleton */
.skeleton { margin-top:.25rem; }
.shimmer { height:12px; border-radius:6px; background:#1a1c25; overflow:hidden; position:relative; }
.shimmer::after {
  content:""; position:absolute; inset:0;
  background:linear-gradient(90deg, transparent, rgba(255,255,255,.06), transparent);
  animation: shimmer 1200ms infinite;
}
.shimmer.line { margin-top:.4rem; }
.shimmer.line.short { width:60%; }
@keyframes shimmer { 0%{transform:translateX(-100%);} 100%{transform:translateX(100%);} }

/* Error box */
.error {
  margin-top:.5rem; background:#2b1d1f; color:#ffdede;
  border:1px solid #e5534b; border-radius:10px; padding:.55rem .7rem;
}

/* Classification */
.classify { margin-top:1rem; }
.classify-row { display:flex; gap:.5rem; margin:.35rem 0 .6rem; }
.classify button[data-class="green"] { background:#234f2e; border-color:#3fb950; color:#dfffe9; }
.classify button[data-class="green"].active { background:#2ea043; border-color:#2ea043; }
.classify button[data-class="yellow"] { background:#4f4a23; border-color:#c9a806; color:#fff7d1; }
.classify button[data-class="yellow"].active { background:#c9a806; border-color:#c9a806; color:#222; }
.classify button[data-class="red"] { background:#4f2323; border-color:#e5534b; color:#ffe1df; }
.classify button[data-class="red"].active { background:#e5534b; border-color:#e5534b; color:#fff; }

/* Action bar */
.action-bar { display:flex; align-items:center; gap:.5rem; margin-top:.6rem; position:sticky; bottom:.5rem; }
.chip { background:#1b1d26; border:1px solid #2a2b33; padding:.25rem .5rem; border-radius:999px; font-size:.85rem; color:#cfd2d8; }
/* === Grove header band (title + line + tools) === */

.grove-header {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  gap: 1.5rem;

  max-width: min(1200px, 96vw);
  margin: 0 auto 0.4rem;
  padding: 0.4rem 0.25rem 0.6rem;

  border-bottom: 1px solid rgba(255,255,255,0.05);
}

.grove-title-block h2 {
  margin-bottom: 0.1rem;
}

.grove-title-block .metaphor-text {
  margin-top: 0.2rem;
}

/* Export / Import look like slim tools, not big primary buttons */
.grove-tools {
  display: flex;
  gap: 0.4rem;
}

.grove-tools button {
  padding: 0.35rem 0.7rem;
  font-size: 0.82rem;
  border-radius: 10px;
  background: rgba(16,20,32,0.9);
  border-color: rgba(255,255,255,0.14);
}

.grove-tools button:hover {
  background: rgba(28,34,52,0.95);
}

/* ------ GROVE (graveyard area) ------ */
.grove-toolbar { display:flex; align-items:center; gap:.5rem; margin:.5rem 0; }
.grove-toolbar .filter-btn {
  background:#22242e; border:1px solid #2a2b33; padding:.35rem .7rem; border-radius:999px; font-size:.9rem; cursor:pointer;
}
.grove-toolbar .filter-btn[aria-pressed="true"] { background:#3b3f52; }
/* let clicks pass through the inscription block */
#groveCanvas foreignObject,
#groveCanvas .stone-inscription {
  pointer-events: none;
}

/* (optional) also let overlays pass clicks through */
#groveCanvas image.overlay {
  pointer-events: none;
}
.grove-fog {
  position: absolute;
  inset: 0;
  background: url('images/fog1.png') repeat-x;
  opacity: 0.045;
  animation: drift 80s linear infinite;
  pointer-events: none;
}

@keyframes drift {
  from { background-position: 0 0; }
  to   { background-position: -2000px 0; }
}





/* Hint under the grove */
.hint { color:#9aa0aa; margin-top:.5rem; font-size:.9rem; }

/* Stones/labels/halos */
.stone:hover { filter: brightness(1.05); }
.stone-halo.green  { stroke:#7bd389; }
.stone-halo.yellow { stroke:#e1d97a; }
.stone-halo.red    { stroke:#ee8a8a; }

/* Type-to-reveal classify */
#classifyBox[hidden]{display:none;}
#classifyBox{opacity:0;transition:opacity .25s ease;}
#classifyBox:not([hidden]){opacity:1;}

/* A11y utility */
.visually-hidden {
  position:absolute !important; height:1px; width:1px; overflow:hidden;
  clip: rect(1px,1px,1px,1px); white-space:nowrap;
}


/* Make ONLY the Grove section full-bleed across the page */
#groveSection.panel {
  width: 100vw;
  max-width: 100vw;
  margin-left: 50%;
  transform: translateX(-50%);
  padding-inline: 0;
}

/* Big responsive graveyard area */
/* Big graveyard ground band */
.grove-frame {
  position: relative;
  margin-top: 0.5rem;

  width: 100vw;
  height: calc(100vh - 210px);   /* tweak if it clips footer */
  min-height: 720px;

  overflow: hidden;
  border-radius: 0;
  border: none;

  /* sky + vignette */
  background:
    radial-gradient(140% 160% at 50% 0%,
      #202431 0%,
      #12141f 40%,
      #070811 75%,
      #020308 100%
    );
}

@keyframes grovePulse {
  0%, 100% {
    transform: scale(1);
    box-shadow: 0 0 40px rgba(0,0,0,0.45);
  }
  50% {
    transform: scale(1.01);
    box-shadow: 0 0 60px rgba(0,0,0,0.6);
  }
}
/* make the SVG fill the padded box cleanly */
.grove-frame > svg#groveCanvas {
  display: block;
  width: 100%;
  height: 100%;
}

.grove-dust {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background-image: radial-gradient(circle at 10% 20%, rgba(255,255,255,0.08) 0, transparent 55%),
                    radial-gradient(circle at 80% 70%, rgba(255,255,255,0.05) 0, transparent 60%);
  background-size: 420px 420px, 520px 520px;
  opacity: 0.08;
  animation: dustDrift 60s linear infinite;
}

@keyframes dustDrift {
  0%   { background-position: 0 0, 0 0; }
  100% { background-position: 600px -200px, -500px 300px; }
}
/* Let SVG stretch to the frame */
#groveCanvas { width: 100%; height: 100%; display: block; }

/* Labels (if you kept them) */

/* If you still have halo elements and want them invisible anyway */
.stone-halo { opacity: 0 !important; }
/* Inscription text inside each tombstone */
.stone-inscription {
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  line-height:1.05;      /* was 1.1 */
  padding:12px 5px;       /* slightly smaller padding */
  color:#1e2026;
  overflow:hidden;
  word-break:break-word;
  hyphens:auto;

  display:-webkit-box;
  -webkit-box-orient:vertical;
  -webkit-line-clamp:4;
}
.stone-history {
  margin-top: 0.75rem;
  padding-top: 0.55rem;
  border-top: 1px solid rgba(255,255,255,0.08);
  font-size: 0.8rem;
  color: #aab0bb;
}

.stone-history__title {
  font-weight: 600;
  margin-bottom: 0.35rem;
  color: #d7dde9;
}

.stone-history__list {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.stone-history__list li {
  display: flex;
  flex-wrap: wrap;
  gap: 0.35rem;
  align-items: baseline;
}

.stone-history__pill {
  padding: 0.15rem 0.5rem;
  border-radius: 999px;
  font-size: 0.78rem;
  border: 1px solid rgba(255,255,255,0.08);
  background: #171924;
}

.stone-history__pill--green {
  border-color: #3fb950;
  background: rgba(25, 111, 63, 0.6);
  color: #e9ffe8;
}

.stone-history__pill--yellow {
  border-color: #c9a806;
  background: rgba(128, 104, 26, 0.6);
  color: #fff7d1;
}

.stone-history__pill--red {
  border-color: #e5534b;
  background: rgba(129, 41, 41, 0.6);
  color: #ffe1df;
}

.stone-history__empty {
  font-size: 0.78rem;
  color: #8f95a3;
}


/* ===== App page right-side ghost ===== */
.app-ghost{
  position:absolute;
  right: min(2vw, 24px);
  top: 120px;                     /* tuned for your header */
  transform: translateY(0);
  color:#e7ebf4;
  opacity:0;
  pointer-events:none;
  transition: opacity 400ms ease, transform 600ms cubic-bezier(.2,.9,.1,1);
  z-index: 30;
}

/* show state */
.app-ghost.on{ opacity:.95 }

/* size like your main ghost */
.app-ghost .sprite{ 
  width: clamp(140px, 22vw, 280px);
  margin-left:auto;
  filter: drop-shadow(0 10px 24px rgba(0,0,0,.45));
}

/* reuse the idle animations & face/mouth hooks from your ghost styles */
/* base eye (open) */
.app-ghost .eye {
  transform-origin: center;
}

/* blink class toggled in JS */
.app-ghost.blink .eye {
  animation: mg-hardBlink var(--blinkDur, 3.4s) ease-in-out 1;
}

@keyframes mg-hardBlink {
  0%   { transform: scaleY(1) translateY(0); }
  10%  { transform: scaleY(0.05) translateY(6px); } /* fully shut */
  20%  { transform: scaleY(1.05) translateY(-1px); } /* re-open a bit “over” */
  25%  { transform: scaleY(1) translateY(0); }
  100% { transform: scaleY(1) translateY(0); }
}
.app-ghost .mouth{ transform-origin:center; transform-box:fill-box; }

/* bubble: reuse your .bubble look; nudge closer */
/* Alias mg-bubble to bubble styles */
.app-ghost .mg-bubble{ 
  position:absolute;
  left: calc(100% px);
  top: 280px;
  transform: translateY(0);
  background: linear-gradient(180deg, rgba(16,22,32,.96), rgba(10,14,22,.94));
  border:1px solid rgba(255,255,255,.15);
  color:#e8edf8;
  border-radius:14px;
  padding:10px 14px;
  font-size: clamp(12px,1.35vw,14px);
  line-height:1.35;
  max-width: clamp(220px, 32vw, 420px);
  white-space: normal;
  box-shadow: 0 10px 30px rgba(0,0,0,.35);
  opacity:0;
  pointer-events:none;
  transition: opacity .20s ease, transform .20s ease;
}
.app-ghost .mg-bubble::after{
  content:"";
  position:absolute; left:-8px; top:16px;
  border-right:8px solid rgba(16,22,32,.96);
  border-top:8px solid transparent;
  border-bottom:8px solid transparent;
}
.app-ghost .mg-bubble.show{ opacity:1; transform: translateY(-2px); }
.app-ghost .mg-bubble.hide{ opacity:0; transform: translateY(0); }


/* ====== Ghost moods + face reactions ====== */

/* neutral is just the base pose */
.app-ghost.mood-neutral {
  transform: translate(0, 0) scale(1);
}

/* LEAN — more obvious interested lean-in */
.app-ghost.mood-lean {
  transform: translate(-40px, -16px) scale(1.25);
}

/* uneasy → stronger tilt + clearly narrowed eyes */
.app-ghost.mood-uneasy .sprite-svg {
  transform: translate(-12px, -14px) rotate(-7deg) scale(1.15);
}
.app-ghost.mood-uneasy .eye {
  transform-origin: center;
  transform: scaleY(0.45) translateY(5px);
}

/* evil → much closer, bigger, heavier eyes + stretched mouth */
/* EVIL: big, close, glowing eyes, crazy mouth */
.app-ghost.mood-evil {
  transform: translate(-90px, -40px) scale(1.9);
  filter: drop-shadow(0 0 18px rgba(255,0,80,.45));
}

.app-ghost.mood-evil .eye {
  transform-origin: center;
  transform: scaleY(0.28) translateY(7px);
  fill: #ff0044;
}

.app-ghost.mood-evil .mouth {
  transform-origin: center;
  transform-box: fill-box;
  animation: mg-evilMouth 0.22s alternate infinite;
}

@keyframes mg-evilMouth {
  0% {
    transform: scale(1.1, 0.6) translateY(5px);
  }
  100% {
    transform: scale(1.3, 0.35) translateY(7px);
  }
}

/* deletion scene: fly toward centre-ish and grow SUPER big */
.app-ghost.mood-delete {
  /* dramatic: big scale, strong shift */
  transform: translate(-55vw, -40px) scale(6.2);
}

/* mouth “talking” while user types */
.app-ghost .mouth.speaking {
  animation: mg-mouth 0.24s alternate infinite;
}
@keyframes mg-mouth {
  0%   { transform: scaleY(0.9) translateY(0); }
  100% { transform: scaleY(1.5) translateY(2px); }
}

/* quick glitch pop used in JS (.glitch-pop) */
.app-ghost.glitch-pop .sprite-svg {
  animation: mg-ghostGlitch 0.26s steps(3, end) 1;
}
@keyframes mg-ghostGlitch {
  0%   { transform: translate(0,0); filter: none; }
  35%  { transform: translate(-5px,3px); filter: hue-rotate(24deg) saturate(1.8) contrast(1.15); }
  70%  { transform: translate(4px,-4px); filter: hue-rotate(-18deg) saturate(1.9) contrast(1.2); }
  100% { transform: translate(2px,-2px); filter: hue-rotate(0deg) saturate(1.5); }
}

/* sneaks a LOT toward the text input */
.app-ghost.mood-sneak {
  transform: translate(-70px, -10px) scale(1.35);
}
.app-ghost.mood-sneak .eye {
  transform-origin: center;
  transform: translateX(-6px);
}

/* colour glitch state for letter-based reactions */
.app-ghost.color-glitch .sprite-svg {
  animation: mg-colorGlitch 0.30s steps(3, end) 1;
  filter: hue-rotate(80deg) contrast(1.8) saturate(2.0);
}
@keyframes mg-colorGlitch {
  0%   { transform: translate(0,0) scale(1); }
  50%  { transform: translate(-3px,4px) scale(1.08); }
  100% { transform: translate(3px,-3px) scale(1.06); }
}

/* bored/wander mode: really drift around for a bit */
.app-ghost.wander {
  animation: mg-wander 13s ease-in-out infinite;
}

@keyframes mg-wander {
  0%   { transform: translate(0, 0) scale(1); }
  15%  { transform: translate(-20vw, -16px) scale(1.12); }
  30%  { transform: translate(-40vw,  26px) scale(1.22); }
  50%  { transform: translate(-60vw, -30px) scale(1.28); } /* very central */
  70%  { transform: translate(-32vw,  20px) scale(1.2); }
  85%  { transform: translate(-12vw, -16px) scale(1.1); }
  100% { transform: translate(0, 0) scale(1); }
}

/* answer pose: closer to centre & clearly bigger */
.app-ghost.mood-answer {
  transform: translate(-45vw, -20px) scale(1.9);
}

/* answer face: intense neon-ish eyes + stretched mouth */
.app-ghost.mood-answer .eye {
  transform-origin: center;
  transform: scaleY(1.0) translateY(4px);
  fill: #22ff5a;
}
.app-ghost.mood-answer .mouth {
  transform-origin: center;
  transform-box: fill-box;
  transform: scaleY(0.8) translateY(6px);
}

/* optional: a faint echo outline while it “delivers” the answer */
.app-ghost.answer-echo .sprite-svg {
  filter: drop-shadow(-6px 0 22px rgba(130,180,255,.55));
}
/* brief little echo clones */
/* brief but VERY visible echo clones */
.app-ghost .ghost-echo-clone{
  position:absolute;
  inset:0;
  opacity:0.75;                     /* was ~0.4 – make it strong */
  pointer-events:none;
  filter: drop-shadow(0 0 12px rgba(130,180,255,.7));
  animation: mg-echoGhost 0.45s ease-out forwards; /* longer */
}

@keyframes mg-echoGhost{
  0%{
    transform: translate(0,0) scale(1);
    opacity:0.9;
  }
  50%{
    transform: translate(8px,-10px) scale(1.12);
    opacity:0.8;
  }
  100%{
    transform: translate(16px,-18px) scale(1.18);
    opacity:0;
  }
}

/* slow, unnerving face tilt */
.app-ghost.face-tilt .sprite-svg{
  animation: mg-faceTilt 4.2s ease-in-out infinite;
  transform-origin: 50% 45%;
}

@keyframes mg-faceTilt{
  0%{
    transform: translate(0,0) rotate(0deg) scale(1);
  }
  35%{
    transform: translate(-3px,-2px) rotate(-3deg) scale(1.03);
  }
  65%{
    transform: translate(2px,1px) rotate(3deg) scale(1.04);
  }
  100%{
    transform: translate(0,0) rotate(0deg) scale(1);
  }
}
/* big faint shadow ghost behind */
.app-ghost .shadow-ghost{
  position:absolute;
  inset:-10%;
  opacity:0.3; /* can bump to 0.4 if you want */
  transform: translate(-40px,-30px) scale(2.6);
  filter: blur(4px);
  pointer-events:none;
}