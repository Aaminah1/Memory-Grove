<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Memory Grove</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="site-header">
    <h1>Memory Grove</h1>
    <nav>
      <button id="tab-ask" class="tab active" aria-controls="ghostSection">Ask the Ghost</button>
      <button id="tab-grove" class="tab" aria-controls="groveSection">
        Your Grove <span id="groveBadge" class="badge" aria-hidden="true" hidden>0</span>
      </button>
    </nav>
  </header>

  <main>
    <!-- Stepper -->
    <div class="stepper" aria-hidden="true">
      <span class="step step-ask active">1. Ask</span>
      <span class="sep">‚Ä∫</span>
      <span class="step step-read">2. Read</span>
      <span class="sep">‚Ä∫</span>
      <span class="step step-classify">3. Classify</span>
      <span class="sep">‚Ä∫</span>
      <span class="step step-plant">4. Plant</span>
    </div>

    <!-- Nudge -->
    <div id="groveNudge" class="nudge" hidden>
      Seed planted. View it in
      <button id="gotoGrove" class="linky" type="button" aria-controls="groveSection">Your Grove</button>.
    </div>

    <!-- ASK -->
    <section id="ghostSection" class="panel">
      <h2>Encounter the Ghost</h2>

      <form id="askForm" class="ask-row" aria-describedby="askHelp">
        <textarea id="question" placeholder="Ask a culturally grounded question‚Ä¶" required minlength="3"></textarea>
        <button id="askBtn" type="submit" disabled>Ask</button>
      </form>
      <p id="askHelp" class="help">
        Tip: ask about practice, story, or meaning (e.g. ‚ÄúWhat does <em>ubuntu</em> mean in everyday life?‚Äù).
      </p>

      <!-- Tombstone (ghost reply) -->
      <div id="tombstoneSection" class="tombstone" hidden>
        <div class="grave-top">
          <div class="grave-icon" aria-hidden="true">ü™¶</div>
          <div class="grave-inscription">Ghost Memory</div>
        </div>

        <!-- loading skeleton -->
        <div id="skeleton" class="skeleton" hidden>
          <div class="shimmer line"></div>
          <div class="shimmer line"></div>
          <div class="shimmer line short"></div>
        </div>

        <!-- errors appear here -->
        <div id="errorBox" class="error" hidden role="alert"></div>

        <p id="tombstoneText" aria-live="polite"></p>

        <div class="classify">
          <p class="help">Choose how it feels:</p>
          <div class="classify-row" role="group" aria-label="Classify the ghost reply">
            <button type="button" data-class="green" title="Resonates (agreement)">Resonates</button>
            <button type="button" data-class="yellow" title="Partial / nuance">Partially right</button>
            <button type="button" data-class="red" title="Counter-memory / reject">Wrong / harmful</button>
          </div>

          <label class="visually-hidden" for="note">Your note</label>
          <textarea id="note" placeholder="Add a correction, nuance, or counter-memory (optional)"></textarea>

          <div class="action-bar">
            <span class="chip" id="selectedChip" hidden>‚Äî</span>
            <button id="plantBtn" type="button" disabled>Plant Seed</button>
          </div>
        </div>
      </div>
    </section>

    <!-- GROVE -->
<section id="groveSection" class="panel" hidden>
  <h2>Your Grove</h2>

  <!-- optional filter bar you can wire later -->
  <div class="grove-toolbar">
    <button class="filter-btn" data-filter="all" aria-pressed="true">All</button>
    <button class="filter-btn" data-filter="green" aria-pressed="false">Green</button>
    <button class="filter-btn" data-filter="yellow" aria-pressed="false">Yellow</button>
    <button class="filter-btn" data-filter="red" aria-pressed="false">Red</button>
  </div>

  <div class="grove-frame">
    <svg id="groveCanvas" viewBox="0 0 1200 700" preserveAspectRatio="xMidYMid meet">
      <!-- background gradient -->
      <defs>
        <linearGradient id="graveGrad" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="#1a1b22"/>
          <stop offset="100%" stop-color="#0f1015"/>
        </linearGradient>
        <linearGradient id="stoneGrad" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="#cfcfd6"/>
          <stop offset="100%" stop-color="#9fa3ad"/>
        </linearGradient>
        <filter id="stoneShadow" x="-20%" y="-20%" width="140%" height="160%">
          <feDropShadow dx="0" dy="4" stdDeviation="4" flood-color="#000" flood-opacity="0.35"/>
        </filter>
      </defs>

      <!-- soft vignette -->
      <rect x="0" y="0" width="1200" height="700" fill="url(#graveGrad)"/>

      <!-- ground -->
      <ellipse cx="600" cy="610" rx="560" ry="80" fill="#0b0c11" opacity="0.9"/>

      <!-- stones will be appended here -->
      <g id="stonesLayer"></g>
    </svg>
  </div>

  <p class="hint">Tip: click a stone to peek the memory. Grid auto-reflows with your window size.</p>
</section>

  </main>

  <footer class="site-footer">
    <small>Prototype for reflection. Seeds are stored locally on this device.</small>
  </footer>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script src="app.js"></script>
</body>
</html>
